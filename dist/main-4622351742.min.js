
/**
 * app.js
 *
 * @version: 0.0.1
 * @update: 2017-3-9
 */

define("config",[],function(){"use strict";return{cache:!1,pushState:!1,swipeBackPage:!1,preloadPreviousPage:!1,popupCloseByOutside:!1,animateNavBackIcon:!0,modalTitle:"系统消息",modalButtonOk:"确定",modalButtonCancel:"取消",smartSelectBackText:"完成",smartSelectBackTemplate:'<div class="left sliding"><a href="#" class="back link"><i class="icon icon-back"></i><span>{{backText}}</span></a></div>',smartSelectPopupCloseText:"关闭",smartSelectPickerCloseText:"完成",smartSelectBackOnSelect:!0}}),define("http",[],function(){var e,n=15e3,t="连接超时，请稍后重试",i={ajax:function(i,a,r,o){var s=new Promise(function(s,l){var c=new XMLHttpRequest,u=a;if(r&&("POST"===i||"PUT"===i)){u+="?";var d=0;for(var f in r)r.hasOwnProperty(f)&&(d++&&(u+="&"),u+=encodeURIComponent(f)+"="+encodeURIComponent(r[f]))}f7.showIndicator(),c.open(i,u),o&&"POST"===i?c.send(o):c.send(),c.onabort=function(){l(t),e&&clearTimeout(e)},e=setTimeout(function(){c.abort()},n),c.onload=function(){if(e&&clearTimeout(e),this.status>=200&&this.status<300){var n=JSON.parse(this.response);0!==n.error_no&&20001!==n.error_no&&20002!==n.error_no&&n.error_no?l(n.error_info):s(n)}else l(this.statusText)},c.onerror=function(){e&&clearTimeout(e),l(this.statusText)}});return s}};return{get:function(e){return i.ajax("GET",e)},post:function(e,n,t){return i.ajax("POST",e,n,t)},put:function(e,n){return i.ajax("PUT",e,n)},delete:function(e){return i.ajax("DELETE",e,args)}}}),define("utils",[],function(){"use strict";var e={bindEvents:function(e){$$.isArray(e)&&e.length>0&&e.forEach(function(e){e.target?$$(e.element).on(e.event,e.target,e.handler):$$(e.element).on(e.event,e.handler)})},unbindEvents:function(e){$$.isArray(e)&&e.length>0&&e.forEach(function(e){e.target?$$(e.element).off(e.event,e.target,e.handler):$$(e.element).off(e.event,e.handler)})},extend:function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),t=1;t<arguments.length;t++){var i=arguments[t];if(void 0!==i&&null!==i)for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])}return n},serialize:function(e){var n,t,i,a,r,o,s,l="";for(n in e)if(t=e[n],t instanceof Array)for(s=0;s<t.length;++s)r=t[s],i=n+"["+s+"]",o={},o[i]=r,l+=serialize(o)+"&";else if(t instanceof Object)for(a in t)r=t[a],i=n+"["+a+"]",o={},o[i]=r,l+=serialize(o)+"&";else void 0!==t&&null!==t&&(l+=encodeURIComponent(n)+"="+encodeURIComponent(t)+"&");return l.length?l.substr(0,l.length-1):l}};return e}),define("services/user",[],function(){function e(e,n,t){var i;if(t){var a=new Date;a.setTime(a.getTime()+24*t*60*60*1e3),i=";expires="+a.toGMTString()}else i="";document.cookie=e+"="+n+i+";path=/"}function n(e){for(var n=e+"=",t=document.cookie.split(";"),i=0;i<t.length;i++){for(var a=t[i];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(n))return a.substring(n.length,a.length)}return null}function t(n){e(n,"",-1)}var i={save:function(n){n.accountId&&e("accountId",n.accountId,7),n.zoneId&&e("zoneId",n.zoneId,7),e("userId",n.userId,7),e("mobile",n.mobile,7),e("userName",encodeURIComponent(n.userName),7),e("isLogin",n.isLogin,7)},getCurrent:function(e){return n(e)},remove:function(){t("accountId"),t("mobile"),t("userName"),t("isLogin"),t("zoneId"),t("userId"),t("openId"),t("nickname")},isLogin:function(){return!!n("isLogin")}};return i}),define("api",["http","utils","services/user"],function(e,n,t){function i(e){return f7.hideIndicator(),e}function a(e){return f7.hideIndicator(),f7.alert(e),r.failed}var r={failed:"failed",appKey:"cairenhuiweixin",appParams:function(){return{appKey:this.appKey,timestamp:(new Date).getTime()}},appUser:function(){return{accountId:t.getCurrent("accountId")}},autoLogin:function(n){return e.post("api/account/userCenter/autoLogin.json",n).then(i,a)},register:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/userCenter/register.json?"+t).then(i,a)},login:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/userCenter/login.json?"+t).then(i,a)},loginen:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/userCenter/loginen.json?"+t).then(i,a)},codeLogin:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/userCenter/verifyCodeLogin.json?"+t).then(i,a)},qqLogin:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/userCenter/qqLogin.json?"+t).then(i,a)},singleLogin:function(t){return data=n.extend(t,this.appParams()),data=n.serialize(data),e.get("api/account/userCenter/autoLoginForZT.json?"+data).then(i,a)},getSMSCode:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/userCenter/getValidateCode.json?"+t).then(i,a)},validateCode:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/userCenter/validateCode.json?"+t).then(i,a)},logout:function(){return e.post("api/account/userCenter/logout.json",this.appParams()).then(i,a)},queryPosition:function(t){return t=n.extend(t,this.appUser(),this.appParams()),t=n.serialize(t),e.get("api/query/queryPosition.json?"+t).then(i,a)},queryOtherPosition:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/query/queryPosition.json?"+t).then(i,a)},queryDayConsign:function(t){return t=n.extend(t,this.appUser(),this.appParams()),t=n.serialize(t),e.get("api/query/queryDayConsign.json?"+t).then(i,a)},queryConsign:function(t){return t=n.extend(t,this.appUser(),this.appParams()),t=n.serialize(t),e.get("api/query/queryConsign.json?"+t).then(i,a)},queryDayTurnover:function(t){return t=n.extend(t,this.appUser(),this.appParams()),t=n.serialize(t),e.get("api/query/queryDayTurnover.json?"+t).then(i,a)},queryTurnover:function(t){return t=n.extend(t,this.appUser(),this.appParams()),t=n.serialize(t),e.get("api/query/queryTurnover.json?"+t).then(i,a)},queryOtherTurnover:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/query/queryTurnover.json?"+t).then(i,a)},queryAccount:function(t){return t=n.extend(t,this.appUser(),this.appParams()),t=n.serialize(t),e.get("api/query/queryAccount.json?"+t).then(i,a)},queryOtherAccount:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/query/queryAccount.json?"+t).then(i,a)},doCancel:function(t){return t=n.extend(t,this.appUser(),this.appParams()),t=n.serialize(t),e.get("api/operate/doCancel.json?"+t).then(i,a)},real:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/stock/quote/real.json?"+t).then(i,a)},doBuy:function(t){return t=n.extend(t,this.appUser(),this.appParams()),t=n.serialize(t),e.get("api/operate/doBuy.json?"+t).then(i,a)},doSell:function(t){return t=n.extend(t,this.appUser(),this.appParams()),t=n.serialize(t),e.get("api/operate/doSell.json?"+t).then(i,a)},sort:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/stock/quote/sort.json?"+t).then(i,a)},queryAllStock:function(){var t=n.serialize(this.appParams());return e.get("api/stock/quote/queryAllStock.json?"+t).then(i,a)},trend:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/stock/quote/trend.json?"+t).then(i,a)},kline:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/stock/quote/kline.json?"+t).then(i,a)},getMaxAvailableBalance:function(t){return t=n.extend(t,this.appUser(),this.appParams()),t=n.serialize(t),e.get("api/query/getMaxAvailableBalance.json?"+t).then(i,a)},vsRank:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/query/queryRank.json?"+t).then(i,a)},vsQueryNoticeList:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/query/querySysNoticeList.json?"+t).then(i,a)},vsQueryNoticeContent:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/query/querySysNotice.json?"+t).then(i,a)},getIssueDate:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/query/queryPeriodLiquidDate.json?"+t).then(i,a)},isRegistered:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/operate/isRegisted.json?"+t).then(i,a)},vsRegister:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/operate/doRegister.json?"+t).then(i,a)},getRegisterNum:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/userCenter/vstockZoneUserCount.json?"+t).then(i,a)},changePsd:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/userCenter/modifyPassword.json?"+t).then(i,a)},getUserProfile:function(){var t=this.appParams();return t=n.serialize(t),e.get("api/account/userCenter/getUserProfile.json?"+t).then(i,a)},getMyFollow:function(){var t=this.appParams();return t=n.serialize(t),e.get("api/account/userCenter/trackingList.json?"+t).then(i,a)},modifyUserProfile:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/userCenter/modifyUserProfile.json?"+t).then(i,a)},trackUser:function(a){return a=n.extend(a,this.appParams()),a=n.serialize(a),e.get("api/account/userCenter/tracking.json?"+a).then(i,function(e){return f7.hideIndicator(),f7.alert(e,function(){t.isLogin()||mainView.loadPage("login.html")}),r.failed})},cancelTrack:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/userCenter/cancelTracking.json?"+t).then(i,a)},queryDayRevenueByDateRange:function(t){return t=n.extend(t,this.appUser(),this.appParams()),t=n.serialize(t),e.get("api/trade/query/queryDayRevenueByDateRange.json?"+t).then(i,a)},queryRevenueLine:function(t){return t=n.extend(t,this.appUser(),this.appParams()),t=n.serialize(t),e.get("api/trade/query/queryRevenueLine.json?"+t).then(i,a)},queryLastLiquidDate:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/trade/query/queryLastLiquidDate.json?"+t).then(i,a)},resetPassword:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/userCenter/resetPassword.json?"+t).then(i,a)},getAccountTrackStatus:function(t){return t=n.extend(t,this.appParams()),e.get("api/account/rank/getAccountTrackStatus.json?accountIds="+t.accountIds+"&appKey=cairenhuiweixin&timestamp="+(new Date).getTime()).then(i,a)},queryUserTrackRank:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/trade/query/queryUserTrackRank.json?"+t).then(i,a)},txEnroll:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/userCenter/signUp.json?"+t).then(i,a)},queryUserDetailRank:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/userCenter/queryUserRank.json?"+t).then(i,a)},queryUserDetailPosition:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/userCenter/queryPosition.json?"+t).then(i,a)},shareAddPoints:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/userCenter/shareAddPoints.json?"+t).then(i,a)},picUpload:function(t,r){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.post("api/account/fileupload/uploadIcon.json?"+t,{},r).then(i,a)},modifyPhoto:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.post("api/account/userCenter/modifyUserProfile.json?"+t).then(i,a)},queryAdvLocation:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/adv.json?"+t).then(i,a)},bindQQ:function(t){return t=n.extend(t,this.appParams()),t=n.serialize(t),e.get("api/account/userCenter/bindQQ.json?"+t).then(i,a)}};return r}),define("services/system",[],function(){function e(e){if(window.WebViewJavascriptBridge)return e(WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];var n=document.createElement("iframe");n.style.display="none",n.src="wvjbscheme://__BRIDGE_LOADED__",document.documentElement.appendChild(n),setTimeout(function(){document.documentElement.removeChild(n)},0)}function n(){if(f7.device.ios)void 0,e(function(e){e.callHandler("BackFunc","hello iOS")});else{if(!f7.device.android)return;void 0,android.finishStockWeb()}}return{closeAPP:n}}),define("router",["api","utils","services/user","services/system"],function(e,n,t,i){function a(e){e.stopPropagation(),e.preventDefault(),t.isLogin()?mainView.router.load({url:this.href,animatePages:!1}):window.location.href.indexOf("chinainvs.trade")!=-1?mainView.router.load({url:"login.html",animatePages:!1}):window.iframe?window.parent.location.replace(window.iframeUrl+"/login"):mainView.router.load({url:"login.html",animatePages:!1})}function r(e,n){e&&e.indexOf("smart-select")===-1&&require(["controllers/"+e+".controller"],function(e){e.init(n)})}function o(){var n="tc-index.html",i=location.href,a=!1;i.indexOf("wxShare")!==-1&&(a=!0),i.indexOf("qqLogin")!==-1&&mainView.router.load({url:"login-qq.html",animatePages:!1}),i.indexOf("bindQQ")!==-1&&mainView.router.load({url:"myprofile.html",animatePages:!1});var r=l();r&&r.indexOf("wxShare")!==-1&&(a=!0);var o=s("token");if(o&&!t.isLogin())e.singleLogin({token:o}).then(function(e){if(void 0,0==e.error_no){t.save({accountId:e.accountId,mobile:e.mobile,userName:e.userName,isLogin:!0,zoneId:e.zoneId,userId:e.userId});var i=s("gopage");if("taaccount"===i){var a=s("accountId");a&&mainView.router.load({url:"user-detail.html?accountId="+a,animatePages:!1})}else"register"===i?mainView.router.load({url:"register.html",animatePages:!1}):"market"===i?mainView.router.load({url:"market.html",animatePages:!1}):"sm"===i?mainView.router.load({url:"vs-index.html",animatePages:!1}):"tx"===i?mainView.router.load({url:"tc-index.html",animatePages:!1}):"trade"===i?t.isLogin()?mainView.router.load({url:"trade.html",animatePages:!1}):mainView.router.load({url:n,animatePages:!1}):"my"===i&&t.isLogin()?mainView.router.load({url:"my.html",animatePages:!1}):mainView.router.load({url:n,animatePages:!1})}});else if(window.location.pathname.indexOf("/login")!==-1)mainView.router.load({url:"login.html",query:{iframe:!0},animatePages:!1});else if(a){var c=s("gopage");if("taaccount"===c){var u=s("accountId");u&&(e.shareAddPoints({accountId:u}).then(function(){}),mainView.router.load({url:"user-detail.html?accountId="+u,animatePages:!1}))}else"singledefault"===c?mainView.router.load({url:"singledefault.html",animatePages:!1}):"singlelogin"===c?mainView.router.load({url:"singlelogin.html",animatePages:!1}):"singlelogout"===c?mainView.router.load({url:"singlelogout.html",animatePages:!1}):"register"===c?mainView.router.load({url:"register.html",animatePages:!1}):"market"===c?mainView.router.load({url:"market.html",animatePages:!1}):"sm"===c?mainView.router.load({url:"vs-index.html",animatePages:!1}):"tx"===c?mainView.router.load({url:"tc-index.html",animatePages:!1}):"trade"===c?t.isLogin()?mainView.router.load({url:"trade.html",animatePages:!1}):mainView.router.load({url:n,animatePages:!1}):"my"===c&&t.isLogin()?mainView.router.load({url:"my.html",animatePages:!1}):mainView.router.load({url:n,animatePages:!1})}else mainView.router.load({url:n,animatePages:!1})}function s(e){var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),t=window.location.search.substr(1).match(n);if(null!==t)return unescape(t[2]);var i=l();if(i&&i.indexOf("?")!==-1){var a=i.split("?")[1];if(t=a.match(n),null!==t)return unescape(t[2])}return null}function l(){var e=null;if(parent!==window)try{e=parent.location.href,e||(e=document.referrer)}catch(n){e=document.referrer}return e}var c={init:function(){f7.onPageInit("*",function(e){r(e.name,e.query)}),$$(document).on("navbarBeforeInit",function(e){var n=e.detail.navbar,t=e.detail.page;t.query&&t.query.internal&&($$(n.innerContainer).find(".hidden").removeClass("hidden"),$$(n.innerContainer).find(".center").css("left","-26.5px"),f7.hideToolbar(".toolbar"))}),o(),n.bindEvents([{element:"body",event:"click",target:"#closeAPP",handler:i.closeAPP},{element:"body",event:"click",target:".authentication",handler:a}])}};return c}),define("template",["utils"],function(e){function n(e,n){var t=$$.isArray(n)?{data:n}:n,i=$$("script"+e),a=i.html(),r=i.parent(),o=Template7.compile(a);r.append(o(t))}function t(e){e=parseFloat(e);var n=e.toLocaleString();return i(n)}function i(e){var n=e.indexOf(".");for(n<0&&(n=e.length,e+=".");e.length<=n+2;)e+="0";return e}return Template7.registerHelper("valueType",function(e){return t(e)}),{render:n}}),define("app",["config","router","template"],function(e,n,t){"use strict";var i={init:function(){window.$$=Dom7,window.f7=new Framework7(e),window.mainView=f7.addView("#mainView",{dynamicNavbar:!0})},boot:function(){n.init()}};return i}),require(["app"],function(e){e.init(),e.boot()}),define("main",function(){}),define("validate",[],function(){var e={isMobile:function(e){return/^[1][34578]\d{9}$/.test(e)},isDigital:function(e){return/^\d+$/.test(e)},isPassword:function(e){return/^(?![^a-zA-Z]+$)(?!\D+$).{8,15}$/.test(e)}};return e}),define("controllers/loginqq.controller",["utils","validate","api","services/user"],function(e,n,t,i){function a(e){$$("#singlelogin").attr("src","http://chaoguh5.china-invs.cn?gopage=singlelogin&wxShare&token="+e.token);var n=0,t=setInterval(function(){if(n+=1,5!==n)window.addEventListener("message",function(n){if("autoLoginSuceess"!=n.data);else if(clearInterval(t),window.location.href.indexOf("chinainvs.trade")!=-1)if(window.location.href.indexOf("gopage")!=-1){var i=(new Date).getTime();window.location.href=window.location.href+"&rnd="+i}else"2"===e.zoneId?mainView.router.load({url:"vs-index.html",animatePages:!1}):mainView.router.load({url:"tc-index.html",animatePages:!1});else window.iframe?window.location.href="http://finance.qq.com/nrh/tx_H5.htm":"2"===e.zoneId?mainView.router.load({url:"vs-index.html",animatePages:!1}):mainView.router.load({url:"tc-index.html",animatePages:!1})},!1);else if(clearInterval(t),window.location.href.indexOf("chinainvs.trade")!=-1)if(window.location.href.indexOf("gopage")!=-1){var i=(new Date).getTime();window.location.href=window.location.href+"&rnd="+i}else"2"===e.zoneId?mainView.router.load({url:"vs-index.html",animatePages:!1}):mainView.router.load({url:"tc-index.html",animatePages:!1});else window.iframe?window.location.href="http://finance.qq.com/nrh/tx_H5.htm":"2"===e.zoneId?mainView.router.load({url:"vs-index.html",animatePages:!1}):mainView.router.load({url:"tc-index.html",animatePages:!1})},200)}function r(e){var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),t=window.location.search.substr(1).match(n);return null!=t?unescape(t[2]):null}function o(e,n,t){var i;if(t){var a=new Date;a.setTime(a.getTime()+24*t*60*60*1e3),i="; expires="+a.toGMTString()}else i="";document.cookie=e+"="+n+i+"; path=/"}var s={init:function(e){var n=3;(e.isRegister||location.href.indexOf("qqLoginRegister")!=-1)&&($$(".other-way").hide(),$$(".iframe-auto-login").hide(),$$(".register").hide(),n=4),$$(".register").click(function(){$$(".other-way").hide(),$$(".iframe-auto-login").hide(),$$(".register").hide(),n=4});var s=r("openId")||i.getCurrent("openId");s&&($$(".page-content").text("正在跳转中").css("padding-top","50px"),o("openId",s,7),t.qqLogin({openId:s,type:n}).then(function(e){if(e===t.failed)return void o("openId","",-1);if(20002==e.error_no){if(4==n)return void setTimeout(function(){mainView.router.load({url:"register.html",animatePages:!1})},1e3);o("openId","",-1),f7.modal({text:e.error_info,buttons:[{text:"确定",onClick:function(){mainView.router.load({url:"login.html",animatePages:!1})}}]})}0==e.error_no&&(i.save({accountId:e.accountId,mobile:e.mobile,userName:e.userName,isLogin:!0,zoneId:e.zoneId,userId:e.userId}),a(e))})),$$("#qqLoginBtn").click(function(){s||s||(4==n?location.href="https://graph.qq.com/oauth2.0/authorize?client_id=101373659&display=mobile&response_type=code&redirect_uri="+window.redirect_uri+"&state="+window.state+"/qqLoginRegister&scope=get_user_info":location.href="https://graph.qq.com/oauth2.0/authorize?client_id=101373659&display=mobile&response_type=code&redirect_uri="+window.redirect_uri+"&state="+window.state+"/qqLogin&scope=get_user_info")})}};return s}),define("controllers/my.controller",["template","utils","api","services/user"],function(e,n,t,i){function a(){window.parent.location.href="http://chaoguh5.china-invs.cn/"}function r(){var e=null;if(parent!==window)try{e=parent.location.href,e||(e=document.referrer)}catch(n){e=document.referrer}return e}function o(){t.logout().then(function(){i.remove(),mainView.router.load({url:"login.html",animatePages:!1})})}var s={init:function(){var a={accountId:i.getCurrent("accountId"),mobile:i.getCurrent("mobile"),userName:decodeURIComponent(i.getCurrent("userName"))};return e.render("#myToolBarTemplate",a),n.unbindEvents(this.bindings),n.bindEvents(s.bindings),e.render("#versionTemplate",{version:"1.0.0"}),a.accountId?(t.queryAccount({isCalMarketValue:!0,isIncludeRevenue:!1}).then(function(t){a.mobile=a.mobile.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"),void 0,e.render("#myTemplate",n.extend({},t,a)),t.result.avatar&&$$("#myAvatar").attr("src",t.result.avatar)}),void(null===r()||r().indexOf("gopage")===-1)):(e.render("#myTemplate",n.extend({},{result:{totalAsset:0}},a)),e.render("#myToolBarTemplate",a),void $$(".hideElement").hide())},bindings:[{element:"#logout",event:"click",handler:o},{element:"body",target:"#backToFlag",event:"click",handler:a}]};return s}),define("controllers/tc-index.controller",["utils","api","template","services/user"],function(e,n,t,i){function a(e){if(i.isLogin()){var t="";if($$(e).each(function(){t=t+","+$$(this).attr("id")}),t=t.substring(1),void 0,!t)return;n.getAccountTrackStatus({accountIds:t}).then(function(e){if(void 0,0==e.error_no){e=e.result;for(var n=e.length-1;n>=0;n--)e[n]=e[n].accountId;void 0;for(var i=e.length-1;i>=0;i--){var a='span[id="'+e[i]+'"]';$$(a).css("background","#817b7b").text("已订阅").parents(".item-inner").find(".item-center").css("color","#e95757")}}})}}function r(){window.parent.location.href="http://chaoguh5.china-invs.cn/"}function o(){var e=null;if(parent!==window)try{e=parent.location.href,e||(e=document.referrer)}catch(n){e=document.referrer}return e}function s(){window.location.href.indexOf("chinainvs.trade")!=-1?mainView.router.load({url:"login.html",animatePages:!1}):window.iframe?window.parent.location.replace(window.iframeUrl+"/login"):mainView.router.load({url:"login.html",animatePages:!1})}function l(){f(k,"TOTAL",y),$$(".income-describe").text("截止："+k)}function c(){f(k,"WEEK",y),$$(".income-describe").text("本周累计")}function u(){f(k,"DAY",y),$$(".income-describe").text(k)}function d(){if(i.isLogin()){var e=i.getCurrent("accountId"),a=i.getCurrent("zoneId"),r=decodeURIComponent(i.getCurrent("userName"));if(void 0,e&&"3"===a){var o={accountId:e,isCalMarketValue:!0,isIncludeRevenue:!0};n.queryAccount(o).then(function(e){void 0,e.result.userName=r,$$(".poster").hide(),$$(".tc-login-block").hide(),t.render("#tcMyInfoTemp",e),$$(".tc-my-vstock").show(),$$(".go-my").show(),$$(".go-tc-register").hide()})}else{var s={result:{userName:r,dayRevenueRank:"/",weekRevenueRank:"/",totalRevenueRank:"/"}};$$(".poster").hide(),$$(".tc-login-block").hide(),t.render("#tcMyInfoTemp",s),$$(".tc-my-vstock").show()}}}function f(e,i,r){var o={issueDate:e,vstockZoneId:r,type:i};n.vsRank(o).then(function(n){void 0,$$(".list-revenue-rank").find("li").remove(),t.render("#vsRankTemplate",n),a(".btn-follow10");var o=$$(".income-describe").text(),s="vs-rank.html?issueDate="+e+"&type="+i+"&describe="+o+"&vstockZoneId="+r;$$(".js-show-more").find("a").attr("href",s)})}function m(){var e=$$(this),n=e.text(),t=e.index()-1,i=P.length;k=t!==i-1?P[t]:x;var a=$$(".btn-income.on").attr("type");"TOTAL"===a?(f(k,"TOTAL",y),$$(".income-describe").text("截止："+k)):"WEEK"===a?(f(k,"WEEK",y),$$(".income-describe").text("本周累计")):(f(k,"DAY",y),$$(".income-describe").text(k)),$$(".js-week-list").find("li").removeClass("selected"),e.addClass("selected"),$$(".week-item").text(n),$$(".js-week-list").addClass("js-hidden").hide()}function h(){f7.swiper(".swiper-container",{speed:1e3,autoplay:3e3,pagination:".swiper-pagination"})}function p(e){var n=$$(".js-week-list");n.hasClass("js-hidden")?n.show().removeClass("js-hidden"):n.addClass("js-hidden").hide(),e.stopPropagation(),$$(document).click(function(){$$(".js-week-list").addClass("js-hidden").hide()})}function g(){var e=$$(this);$$(".btn-income").removeClass("on"),e.addClass("on")}function v(){var e=$$(this),t=e.attr("id");n.trackUser({trackedAccountId:t}).then(function(t){if(t!==n.failed){var i;0===t.error_no&&(e.css("background","#817b7b").text("已订阅").parents(".item-inner").find(".item-center").css("color","#e95757"),i="您已订阅了此高手。您可以下载“掌中投”客户端，查看此高手实时操盘数据；也可以点击“进入我的账户”查看此高手持仓。",f7.modal({title:"",text:i,buttons:[{text:"确定",close:!0},{text:'<a class="external" href="http://www.china-invs.cn/web001/wbtg/tencent/mobile/tencent_zzt.html">去下载</a>'}]})),20001===t.error_no&&(void 0,w()),20002===t.error_no&&(void 0,i="您最多订阅10个高手",f7.alert(i))}})}function w(){f7.modal({text:'<div style="text-align: left">非中投客户只能订阅1个高手，中投客户可订阅10个高手。马上开户，看更多高手如何实时操盘。</div>',buttons:[{text:"再逛逛",onClick:function(){f7.closeModal()}},{text:"马上开户",onClick:function(){f7.closeModal(),window.parent.location.href="http://www.china-invs.cn/web001/wbtg/tencent/mobile/tencent_ykh.html"}}]})}function $(){window.parent.location.href="http://chaoguh5.china-invs.cn/?gopage=qqGroupIndex&wxShare"}var k,x,b,y=3,P=[];window.theTxRankData=function(e){void 0,k=e.issueDate,x=k;for(var n=e.weekDefines,i=0,r=n.length;i<r;i++)P.push(n[i].endDate);var o=e.list,s={};s.result={dataList:o},t.render("#vsRankTemplate",s),$$(".data-update-time").text(e.issueDateStr);var l="截止："+k;$$(".income-describe").text(l);var c="vs-rank.html?issueDate="+k+"&type=TOTAL&describe="+l+"&vstockZoneId="+y;$$(".js-show-more").find("a").attr("href",c),$$("#linkRevenueRank").attr("href",c),a(".btn-follow10");for(var u=e.currentWeek||0,d=0;d<u;d++){var f,m=d+1;f=m<u?'<li class="week tc-index-week">第'+m+"周</li>":'<li class="week tc-index-week selected">第'+m+"周</li>",$$(".js-week-list").append(f)}$$(".week-item").text("第"+u+"周")},window.theTxUserTrackRankData=function(e){void 0;var n=e.list,i={};i.result={dataList:n},t.render("#vsUserRankTemplate",i),a(".btn-follow-user10")};var T={init:function(){b={accountId:i.getCurrent("accountId")},t.render("#tcToolBarTemplate",b),d(),$$.ajax({url:window.backendAddr+"/html/rank/tencentH5Rank/h5Rank_3.txt?callback=?",type:"GET",dataType:"json"}),$$.ajax({url:window.backendAddr+"/html/userTrackRank/tencentH5UserTrackRank/h5UserTrackRank_3.txt?callback=？",type:"GET",dataType:"json"}),e.unbindEvents(this.bindings),e.bindEvents(this.bindings),h();var n=i.getCurrent("accountId");if(n){void 0;try{window.parent.postMessage({link:"http://h5.sm.98084.com/?gopage=taaccount&accountId="+n+"&wxShare"},"*")}catch(e){}}null===o()||o().indexOf("gopage")===-1},bindings:[{element:"body",target:".tc-btn-total-income",event:"click",handler:l},{element:"body",target:".tc-index-login",event:"click",handler:s},{element:"body",target:".tc-btn-week-income",event:"click",handler:c},{element:"body",target:".tc-btn-daily-income",event:"click",handler:u},{element:"body",target:".tc-index-week",event:"click",handler:m},{element:"body",target:".tc-range",event:"click",handler:p},{element:"body",target:".tc-btn-income",event:"click",handler:g},{element:"body",target:".tc-btn-follow",event:"click",handler:v},{element:"body",target:".goQQGroupBtn",event:"click",handler:$},{element:"body",target:"#backToFlag",event:"click",handler:r}]};return T}),define("controllers/vs-index.controller",["utils","api","template","services/user"],function(e,n,t,i){function a(e){if(i.isLogin()){var t="";if($$(e).each(function(){t=t+","+$$(this).attr("id")}),t=t.substring(1),void 0,!t)return;n.getAccountTrackStatus({accountIds:t}).then(function(e){void 0,e=e.result;for(var n=e.length-1;n>=0;n--)e[n]=e[n].accountId;void 0;for(var i=e.length-1;i>=0;i--){var a='span[id="'+e[i]+'"]';$$(a).css("background","#817b7b").text("已订阅").parents(".item-inner").find(".link-detail").css("color","#e95757")}})}}function r(){window.parent.location.href="http://chaoguh5.china-invs.cn/"}function o(){var e=null;if(parent!==window)try{e=parent.location.href,e||(e=document.referrer)}catch(n){e=document.referrer}return e}function s(){h(b,"TOTAL"),$$(".income-describe-first").text("截止："+b)}function l(){h(b,"WEEK"),$$(".income-describe-first").text("本周累计")}function c(){h(b,"DAY"),$$(".income-describe-first").text(b)}function u(){h(T,"TOTAL","final"),$$(".income-describe-final").text("截止："+T)}function d(){h(T,"WEEK","final"),$$(".income-describe-final").text("本周累计")}function f(){h(T,"DAY","final"),$$(".income-describe-final").text(T)}function m(){if(i.isLogin()){var e=i.getCurrent("accountId"),a=i.getCurrent("zoneId");if(e&&"2"===a){var r={accountId:e,isCalMarketValue:!0,isIncludeRevenue:!0};n.queryAccount(r).then(function(e){void 0,$$(".poster").hide(),t.render("#vsMyInfoTemp",e),$$(".my-vstock").show()})}else{var o={result:{totalRevenueRank:"--",totalAsset:"--",cysAmount:"--",totalRevenueRate:"--"}};$$(".poster").hide(),t.render("#vsMyInfoTemp",o),$$(".total-num").text("--"),$$(".balance-num").text("--"),$$(".my-vstock").show()}}}function h(e,i,r){var o={issueDate:e,vstockZoneId:C,type:i,step:r};r?(o.vstockZoneId=1000002,n.vsRank(o).then(function(n){$$(".list-revenue-rank-js").find("li").remove(),t.render("#vsFinalRankTemplate",n),a(".btn-follow10");var r=$$(".income-describe-final").text(),s="vs-rank.html?issueDate="+e+"&type="+i+"&describe="+r+"&vstockZoneId="+o.vstockZoneId;$$(".js-show-more-final").find("a").attr("href",s)})):n.vsRank(o).then(function(n){$$(".list-revenue-rank").find("li").remove(),t.render("#vsRankTemplate",n),a(".btn-follow10");var r=$$(".income-describe").text(),o="vs-rank.html?issueDate="+e+"&type="+i+"&describe="+r+"&vstockZoneId="+C;$$(".js-show-more").find("a").attr("href",o)})}function p(e){var n=$$(".js-week-list");n.hasClass("js-hidden")?n.show().removeClass("js-hidden"):n.addClass("js-hidden").hide(),e.stopPropagation(),$$(document).click(function(){$$(".js-week-list").addClass("js-hidden").hide()})}function g(e){var n=$$(".js-week-list-final"),t="第0周"!=$$(".week-item-final").text();n.hasClass("js-hidden")&&t?n.show().removeClass("js-hidden"):n.addClass("js-hidden").hide(),e.stopPropagation(),$$(document).click(function(){$$(".js-week-list-final").addClass("js-hidden").hide()})}function v(){var e=$$(this),n=e.text(),t=e.index()-1,i=I.length;b=t!==i-1?I[t]:y;var a=$$(".btn-income-first.on").attr("type");"TOTAL"===a?(h(b,"TOTAL"),$$(".income-describe-first").text("截止："+b)):"WEEK"===a?(h(b,"WEEK"),$$(".income-describe-first").text("本周累计")):(h(b,"DAY"),$$(".income-describe-first").text(b)),$$(".js-week-list").find("li").removeClass("selected"),e.addClass("selected"),$$(".week-item").text(n),$$(".js-week-list").addClass("js-hidden").hide()}function w(){var e=$$(this),n=e.text(),t=e.index()-1,i=q.length;T=t!==i-1?q[t]:j;var a=$$(".btn-income-final.on").attr("type");"TOTAL"===a?(h(T,"TOTAL","final"),$$(".income-describe-final").text("截止："+T)):"WEEK"===a?(h(T,"WEEK","final"),$$(".income-describe-final").text("本周累计")):(h(T,"DAY","final"),$$(".income-describe-final").text(T)),$$(".js-week-list-final").find("li").removeClass("selected"),e.addClass("selected"),$$(".week-item-final").text(n),$$(".js-week-list-final").addClass("js-hidden").hide()}function $(){var e=$$(this);e.addClass("on").siblings().removeClass("on")}function k(){var e=$$(this),t=e.attr("id");n.trackUser({trackedAccountId:t}).then(function(t){if(t!==n.failed){var i;0===t.error_no&&(e.css("background","#817b7b").text("已订阅").parents(".item-inner").find(".item-center").css("color","#e95757"),i="您已订阅了此高手。您可以下载“掌中投”客户端，查看此高手实时操盘数据；也可以点击“进入我的账户”查看此高手持仓。",f7.modal({title:"",text:i,
buttons:[{text:"确定",close:!0},{text:'<a class="external" href="http://www.china-invs.cn/web001/wbtg/tencent/mobile/tencent_zzt.html">去下载</a>'}]})),20001===t.error_no&&(void 0,x()),20002===t.error_no&&(void 0,i="您最多订阅10个高手",f7.alert(i))}})}function x(){f7.modal({text:'<div style="text-align: left">非中投客户只能订阅1个高手，中投客户可订阅10个高手。马上开户，看更多高手如何实时操盘。</div>',buttons:[{text:"再逛逛",onClick:function(){f7.closeModal()}},{text:"马上开户",onClick:function(){f7.closeModal(),window.parent.location.href="http://www.china-invs.cn/web001/wbtg/tencent/mobile/tencent_ykh.html"}}]})}var b,y,P,T,j,C=2,I=[],q=[];window.theRankData=function(e){void 0,b=e.issueDate,y=b;for(var n=e.weekDefines,i=0,a=n.length;i<a;i++)I.push(n[i].endDate);var r=e.list,o={};o.result={dataList:r},t.render("#vsRankTemplate",o);var s="截止："+b;$$(".income-describe-first").text(s);var l="vs-rank.html?issueDate="+b+"&type=TOTAL&describe="+s+"&vstockZoneId="+C;$$(".js-show-more").find("a").attr("href",l);for(var c=e.currentWeek||0,u=0;u<c;u++){var d,f=u+1;d=f<c?'<li class="week index-week">第'+f+"周</li>":'<li class="week index-week selected">第'+f+"周</li>",$$(".js-week-list").append(d)}$$(".week-item").text("第"+c+"周")},window.theSimuFinalRankData=function(e){void 0,T=e.issueDate,j=T;for(var n=e.weekDefines,i=0,r=n.length;i<r;i++)q.push(n[i].endDate);var o=e.list||[],s={};s.result={dataList:o},t.render("#vsFinalRankTemplate",s);var l="截止："+T;$$(".income-describe-final").text(l);var c="vs-rank.html?issueDate="+T+"&type=TOTAL&describe="+l+"&vstockZoneId=1000002";$$(".js-show-more-final").find("a").attr("href",c),a(".btn-follow10");for(var u=e.currentWeek||0,d=0;d<u;d++){var f,m=d+1;f=m<u?'<li class="week index-week-final">第'+m+"周</li>":'<li class="week index-week-final selected">第'+m+"周</li>",$$(".js-week-list-final").append(f)}$$(".week-item-final").text("第"+u+"周")},window.theUserTrackRankData=function(e){void 0;var n=e.list,i={};i.result={dataList:n},t.render("#vsUserRankTemplate",i),a(".btn-follow-user10")};var z={init:function(){P={accountId:i.getCurrent("accountId")},t.render("#myToolBarTemplate",P),m(),$$.ajax({url:window.backendAddr+"/html/rank/simuH5Rank/h5Rank_2.txt?callback=?",type:"GET",dataType:"json"}),$$.ajax({url:window.backendAddr+"/html/rank/simuFinalH5Rank/h5Rank_1000002.txt?callback=?",type:"GET",dataType:"json"}),$$.ajax({url:window.backendAddr+"/html/userTrackRank/simuH5UserTrackRank/h5UserTrackRank_2.txt?callback=?",type:"GET",dataType:"json"}),e.unbindEvents(this.bindings),e.bindEvents(this.bindings);var n=i.getCurrent("accountId");if(n){void 0;try{window.parent.postMessage({link:"http://h5.sm.98084.com/?gopage=taaccount&accountId="+n+"&wxShare"},"*")}catch(e){}}null===o()||o().indexOf("gopage")===-1},bindings:[{element:"body",target:".btn-total-income",event:"click",handler:s},{element:"body",target:".btn-total-income-final",event:"click",handler:u},{element:"body",target:".btn-week-income",event:"click",handler:l},{element:"body",target:".btn-week-income-final",event:"click",handler:d},{element:"body",target:".btn-daily-income",event:"click",handler:c},{element:"body",target:".btn-daily-income-final",event:"click",handler:f},{element:"body",target:".sm-range",event:"click",handler:p},{element:"body",target:".sm-range-final",event:"click",handler:g},{element:"body",target:".index-week",event:"click",handler:v},{element:"body",target:".index-week-final",event:"click",handler:w},{element:"body",target:".sm-btn-income",event:"click",handler:$},{element:"body",target:".sm-btn-follow",event:"click",handler:k},{element:"body",target:"#backToFlag",event:"click",handler:r}]};return z});